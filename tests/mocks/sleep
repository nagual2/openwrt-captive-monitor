#!/bin/sh
set -eu
. "$(dirname "$0")/_lib.sh"

mock_log sleep "$@"

state_file=$(mock_state_file sleep)
if [ "${MOCK_SLEEP_TERMINATE:-}" = "1" ]; then
  if [ ! -f "$state_file" ]; then
    : > "$state_file"
    kill -TERM "$PPID" 2> /dev/null || true
  fi
fi

if [ "${MOCK_SLEEP_FAST:-}" = "1" ]; then
  exit 0
fi

if [ -n "${REAL_SLEEP_BIN:-}" ] && [ -x "${REAL_SLEEP_BIN:-}" ]; then
  exec "$REAL_SLEEP_BIN" "$@"
fi

exit 0
